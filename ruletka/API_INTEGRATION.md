# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend API

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ —Å –±–µ–∫–µ–Ω–¥ API.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ `ruletka/` –Ω–∞ –æ—Å–Ω–æ–≤–µ `.env.example`:

```bash
cp .env.example .env
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `.env` –∏ —É–∫–∞–∂–∏—Ç–µ URL –≤–∞—à–µ–≥–æ –±–µ–∫–µ–Ω–¥–∞:

```env
VITE_API_URL=http://localhost:8080
```

### 2. –ó–∞–ø—É—Å–∫ –±–µ–∫–µ–Ω–¥–∞

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –±–µ–∫–µ–Ω–¥–∞ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä:

```bash
cd ../ruletka-backend
docker-compose up -d  # –ó–∞–ø—É—Å—Ç–∏—Ç—å PostgreSQL
make run              # –ó–∞–ø—É—Å—Ç–∏—Ç—å API —Å–µ—Ä–≤–µ—Ä
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–µ–∫–µ–Ω–¥ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `http://localhost:8080`

### 3. –ó–∞–ø—É—Å–∫ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

```bash
cd ruletka
npm install
npm run dev
```

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞:

1. **–û—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
   - –ò–≥—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
   - –ë–∞–ª–∞–Ω—Å —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

2. **–û–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º** (–ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)
   - –ë–∞–ª–∞–Ω—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º
   - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–ø–∏–Ω–æ–≤ –ø–æ–ª—É—á–∞—é—Ç—Å—è –æ—Ç API
   - –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üîê –í–æ–π—Ç–∏"** –≤ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏
2. –í—ã–±–µ—Ä–∏—Ç–µ **"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è"** –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
3. –ò–ª–∏ **"–í—Ö–æ–¥"** –µ—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç

–ü–æ—Å–ª–µ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è –≤ –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º.

### –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

–í –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ:
1. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **"üí∞ –ü–æ–ø–æ–ª–Ω–∏—Ç—å"**
2. –í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É
3. –ù–∞–∂–º–∏—Ç–µ **"–ü–æ–ø–æ–ª–Ω–∏—Ç—å"**

–ë–∞–ª–∞–Ω—Å –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –∫–ª–∏–µ–Ω—Ç–æ–º.

## üîß –°—Ç—Ä—É–∫—Ç—É—Ä–∞ API

### API –ú–æ–¥—É–ª–∏

```
src/shared/api/
‚îú‚îÄ‚îÄ client.ts      # Axios –∫–ª–∏–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
‚îú‚îÄ‚îÄ types.ts       # TypeScript —Ç–∏–ø—ã –¥–ª—è API
‚îú‚îÄ‚îÄ auth.ts        # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (login, register, logout)
‚îú‚îÄ‚îÄ user.ts        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ (balance, deposit)
‚îú‚îÄ‚îÄ game.ts        # –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (spin)
‚îî‚îÄ‚îÄ index.ts       # –≠–∫—Å–ø–æ—Ä—Ç—ã
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ API –º–µ—Ç–æ–¥—ã

#### AuthAPI

```typescript
import { AuthAPI } from '@shared/api';

// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
await AuthAPI.register({ email, password });

// –í—Ö–æ–¥
const response = await AuthAPI.login({ email, password });
// response.token - JWT —Ç–æ–∫–µ–Ω
// response.user - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

// –í—ã—Ö–æ–¥
AuthAPI.logout();

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
const isAuth = AuthAPI.isAuthenticated();
```

#### UserAPI

```typescript
import { UserAPI } from '@shared/api';

// –ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å
const balance = await UserAPI.getBalance();

// –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
const newBalance = await UserAPI.deposit(amount);
```

#### GameAPI

```typescript
import { GameAPI } from '@shared/api';

// –í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ø–∏–Ω
const result = await GameAPI.spin(bet);
// result.reels - –±–∞—Ä–∞–±–∞–Ω—ã —Å —Å–∏–º–≤–æ–ª–∞–º–∏
// result.winAmount - —Å—É–º–º–∞ –≤—ã–∏–≥—Ä—ã—à–∞
// result.balance - –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å
// result.winningLines - –≤—ã–∏–≥—Ä—ã—à–Ω—ã–µ –ª–∏–Ω–∏–∏
```

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–¢–æ–∫–µ–Ω JWT —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `localStorage` –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization: Bearer <token>`.

–ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ 401 (Unauthorized), —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º.

## üéÆ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Store

Game Store –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã:

```typescript
import { useGameStore } from '@entities/game';

const {
  useOnlineMode,      // true –µ—Å–ª–∏ –≤ –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ
  setOnlineMode,      // –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º
  syncBalance,        // —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–∞–ª–∞–Ω—Å —Å —Å–µ—Ä–≤–µ—Ä–æ–º
  deposit,            // –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å
  spin,               // –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–ø–∏–Ω (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API –≤ –æ–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º–µ)
} = useGameStore();
```

## üåê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|-----------|----------|--------------|
| `VITE_API_URL` | URL –±–µ–∫–µ–Ω–¥ API | `http://localhost:8080` |

## üîç –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–í—Å–µ API –º–µ—Ç–æ–¥—ã –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö:

```typescript
try {
  await GameAPI.spin(bet);
} catch (error) {
  // error.message —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
  console.error(error.message);
}
```

–û—Å–Ω–æ–≤–Ω—ã–µ –æ—à–∏–±–∫–∏:
- `invalid credentials` - –Ω–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å
- `user already exists` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω
- `insufficient balance` - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤
- `invalid bet amount` - –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞
- `unauthorized` - —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã

```typescript
import { AuthAPI, UserAPI, GameAPI } from '@shared/api';

// 1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
await AuthAPI.register({
  email: 'test@example.com',
  password: 'password123'
});

// 2. –í—Ö–æ–¥
const { token, user } = await AuthAPI.login({
  email: 'test@example.com',
  password: 'password123'
});

// 3. –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
await UserAPI.deposit(100);

// 4. –ò–≥—Ä–∞
const result = await GameAPI.spin(10);
console.log('Win:', result.winAmount);
console.log('Balance:', result.balance);

// 5. –í—ã—Ö–æ–¥
AuthAPI.logout();
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª `ruletka-backend/api_examples.http` –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API endpoints –Ω–∞–ø—Ä—è–º—É—é.

### –û—Ç–ª–∞–¥–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
2. –í—Å–µ –æ—à–∏–±–∫–∏ API –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
3. –°–æ—Å—Ç–æ—è–Ω–∏–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ `localStorage` ‚Üí `auth_token`

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### CORS –æ—à–∏–±–∫–∏

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–µ–∫–µ–Ω–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø—Ä–∏–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –≤–∞—à–µ–≥–æ –¥–æ–º–µ–Ω–∞. –í `ruletka-backend` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω CORS middleware.

### –¢–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `localStorage` –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ –∏ –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

### API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–µ–∫–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω: `curl http://localhost:8080/health`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `VITE_API_URL` –≤ `.env`
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ø–æ—Ä—Ç—ã –Ω–µ –∑–∞–Ω—è—Ç—ã –¥—Ä—É–≥–∏–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [Backend README](../ruletka-backend/README.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±–µ–∫–µ–Ω–¥–∞
- [API Examples](../ruletka-backend/api_examples.http) - –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- [Game Rules](./GAME_RULES.md) - –ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É websocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–≥—Ä
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

